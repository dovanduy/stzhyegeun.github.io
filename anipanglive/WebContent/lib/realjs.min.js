var REALJS_DEBUG=!0;!function(a,b){"use strict";function c(b,c){a.$&&"function"==typeof a.$.getscript?$.getscript(b,function(){c&&c()}):$.ajax({url:b,dataType:"script",async:!1,success:function(){c&&c()},error:function(){throw new Error("Could not load script: "+b)}})}"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("realjs requires a window with a document");return b(a)}:c("lib/socket.io.js",function(){b(a)})}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c=function(){var a=function(){this._list=[],this.add=function(a,b){var c=b?a.bind(b):a;this._list.indexOf(c)>=0||this._list.push(c)},this.remove=function(a,b){var c=b?a.bind(b):a,d=this._list.indexOf(c);d<0||this._list.splice(d,1)},this.removeAll=function(){this._list.splice(0,this._list.length)}};this.connectListener=new a,this.loginListener=new a,this.joinLobbyListener=new a,this.getRoomListListener=new a,this.createRoomListener=new a,this.leaveRoomListener=new a,this.joinRoomListener=new a,this.roomReadyListener=new a,this.messageListener=new a,this.roomStartListener=new a},d=function(){var b=!1;this.getIsServerWaiting=function(){return b};var d=null;this.getJoinedRoomId=function(){return d},this.getWaitStartTime=function(){return null};var f=null;this.getMySessionId=function(){return f},this.EState={NONE:0,CONNECT:1,INIT:2,LOGIN:3,JOIN_LOBBY:4,GET_ROOM_LIST:5,CREATE_ROOM:6,JOIN_ROOM:7,ROOM_READY:8,WAITING:9,MESSAGE:10,END:11},this.realState=this.EState.NONE,this.realSocket=null,this.event=new c,this.realConnect=function(a,c){this.realSocket=io.connect(a,c),REALJS_DEBUG&&console.log("[realjs-realConnect] url: "+a+", inOptions: "+c),this.realSocket.on("IO:WELCOME",function(a){if(b=!1,!a)throw new Error("[realjs-on] IO:WELCOME failed!!");REALJS_DEBUG&&console.log("[realjs-on] IO:WELCOME | data: "+a),this.realState=this.EState.CONNECT;for(var c=this.event.connectListener._list.length-1;c>=0;c--)this.event.connectListener._list[c](a)}.bind(this)),this.realSocket.on("IO:LOGIN",function(a){if(b=!1,!a)throw new Error("[realjs-on] IO:LOGIN failed!!");REALJS_DEBUG&&console.log("[realjs-on] IO:LOGIN | s_id: "+a.s_id+", t: "+a.t),this.realState=this.EState.LOGIN,f=a.s_id;for(var c=this.event.loginListener._list.length-1;c>=0;c--)this.event.loginListener._list[c](a)}.bind(this)),this.realSocket.on("ROOM:JOIN",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:JOIN failed!!");if(REALJS_DEBUG&&console.log("[realjs-on] ROOM:JOIN | data.type: "+a.type+", roomId: "+a.room_id+", memberCount: "+a.members.length),"ROOM:JOIN"!==a.type)return!1;if(d=a.room_id,"lobby"===a.room_id){this.realState=this.EState.JOIN_LOBBY;for(var c=this.event.joinLobbyListener._list.length-1;c>=0;c--)this.event.joinLobbyListener._list[c](a)}else for(this.realState=this.EState.JOIN_ROOM,c=this.event.joinRoomListener._list.length-1;c>=0;c--)this.event.joinRoomListener._list[c](a)}.bind(this)),this.realSocket.on("ROOM:LIST",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:LIST failed!!");REALJS_DEBUG&&console.log("[realjs-on] ROOM:LIST | roomCount: "+a.room_list.length),this.realState=this.EState.GET_ROOM_LIST;for(var c=this.event.getRoomListListener._list.length-1;c>=0;c--)this.event.getRoomListListener._list[c](a)}.bind(this)),this.realSocket.on("ROOM:START",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:START failed!!");REALJS_DEBUG&&console.log("[realjs-on] ROOM:START | room_id: ");for(var c=this.event.roomStartListener._list.length-1;c>=0;c--)this.event.roomStartListener._list[c](a)}.bind(this)),this.realSocket.on("ROOM:MESSAGE",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:MESSAGE failed!!");if(a.room==this.getJoinedRoomId()&&a.sid!==this.getMySessionId()){REALJS_DEBUG&&console.log("[realjs-on] ROOM:MESSAGE | room: "+a.room+", t: "+a.t),this.realState=this.EState.MESSAGE;for(var c=this.event.messageListener._list.length-1;c>=0;c--)this.event.messageListener._list[c](a)}}.bind(this)),this.realSocket.on("ROOM:LEAVE",function(a){if(!a)throw new Error("[realjs-on] ROOM:LEAVE failed!!");REALJS_DEBUG&&console.log("[realjs-on] ROOM:LEAVE");for(var b=this.event.leaveRoomListener._list.length-1;b>=0;b--)this.event.leaveRoomListener._list[b](a)}.bind(this)),this.realSocket.on("ROOM:CREATE",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:CREATE failed!!");REALJS_DEBUG&&console.log("[realjs-on] ROOM:CREATE | roomId: "+a.room_id+", ok: "+a.ok),this.realState=this.EState.CREATE_ROOM;for(var c=this.event.createRoomListener._list.length-1;c>=0;c--)this.event.createRoomListener._list[c](a)}.bind(this)),this.realSocket.on("ROOM:READY",function(a){if(b=!1,!a)throw new Error("[realjs-on] ROOM:READY failed!!");REALJS_DEBUG&&console.log("[realjs-on] ROOM:READY | ok: "+a.ok),this.realState=this.EState.ROOM_READY;for(var c=this.event.roomReadyListener._list.length-1;c>=0;c--)this.event.roomReadyListener._list[c](a)}.bind(this))}.bind(this),this.realGetUserInfo=function(b,c,d){if(void 0===a.$)return this.realState=EState.NONE,!1;var e="https://html5.stzapp.net:11001/api/user/info?user_ids=";if("object"==typeof b)for(var f=0;f<b.length;f++)e+=0===f?b[f]:","+b[f];else e+=b;$.get(e,function(a){if(!a)throw new Error("[realjs-on] GET user info failed!!");void 0!==c&&null!=c&&(void 0!==d&&null!=d?c.call(d,a):c(a))})},this.realInitUser=function(c,d,e,f,g){if(void 0===a.$)return this.realState=EState.NONE,!1;if(!0===b)return!1;var h="https://html5.stzapp.net:11001/api/init?platform_id="+c;return void 0!==d&&(h=h+"&name="+d),void 0!==e&&(h=h+"&thumbnail="+encodeURIComponent(e)),$.get(h,function(a){if(!a)throw new Error("[realjs-on] INIT failed!!");REALJS_DEBUG&&console.log("[realjs-on] INIT | id: "+a.id),this.realState=this.EState.INIT,void 0!==f&&null!=f&&(void 0!==g&&null!=g?f.call(g,a.id):f(a.id))}.bind(this)),REALJS_DEBUG&&console.log("[realjs-realLogin] userId: "+c+", userName: "+d+", \nthumbnail: "+e),!0}.bind(this),this.realLogin=function(a,c,d){this.realInitUser(a,c,d,function(e){if(null===this.realSocket)return this.realState=NONE,!1;if(!0===b)return!1;var f="IO:LOGIN",g={type:f,user_id:e};return this.realSocket.emit(f,g),b=!0,REALJS_DEBUG&&console.log("[realjs-realLogin] userId: "+a+", userName: "+c+", \nthumbnail: "+d),!0},this)}.bind(this),this.realJoinLobby=function(a){if(a&&!0===b)return!1;var c="ROOM:JOIN",d="lobby",e={type:c,room_id:d};return this.realSocket.emit(c,e),b=a&&!0,REALJS_DEBUG&&console.log("[realjs-realJoinLobby] isBlock: "+a),!0}.bind(this),this.realRoomStart=function(){if(!0===b)return!1;var a="ROOM:START",c=this.getJoinedRoomId();if("gr:"===c.substring(0,3)){var d={type:a,room_id:c};return this.realSocket.emit(a,d),b=!0,REALJS_DEBUG&&console.log("[realjs-realRoomStart] roomId: "+c),!0}return!1}.bind(this),this.realJoinRoomById=function(a){if(!0===b)return!1;var c="ROOM:JOIN";if("gr:"===a.substring(0,3)){var d={type:c,room_id:a};return this.realSocket.emit(c,d),b=!0,REALJS_DEBUG&&console.log("[realjs-realJoinRoomById] roomId: "+a),!0}return!1}.bind(this),this.realGetRoomList=function(){if(!0===b)return!1;var a="ROOM:LIST",c={type:a};return this.realSocket.emit(a,c),b=!0,REALJS_DEBUG&&console.log("[realjs-realGetRoomList]"),!0}.bind(this),this.realCreateRoom=function(a){if(!0===b)return!1;var c="ROOM:CREATE",d=a||"0",e={type:c,room_id:d};return this.realSocket.emit(c,e),b=!0,REALJS_DEBUG&&console.log("[realjs-realCreateRoom] roomId: "+d),!0}.bind(this),this.realRoomReady=function(){if(!0===b)return!1;if(null===d)return!1;var a="ROOM:READY",c={type:a,room_id:d};return this.realSocket.emit(a,c),b=!0,REALJS_DEBUG&&console.log("[realjs-realRoomReady]"),!0}.bind(this),this.realSendMessage=function(a,c){if(c&&!0===b)return!1;if("lobby"===this.getJoinedRoomId())return!1;var d=a.trim();return!!d&&(this.realSocket.emit("ROOM:MESSAGE",d),b=c&&!0,REALJS_DEBUG&&console.log("[realjs-realSendMessage] message: "+d+", isBlock: "+c),!0)}.bind(this)},e=new d;b||(a.realjs=e)});